<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Tic Tac Toe!</title>
    <style>

        body {
            background: #86C2B4;
            margin: 0;
        }

        #dvmenu {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: #F4E9C1;
            padding: 20px 0;
        }

        #dvGame {
            width: 270px;
            height: 270px;
            display: flex;
            flex-wrap: wrap;
            align-content: flex-start;
            margin: 45px auto;
        }

        .positionGame {
            width: 85px;
            height: 85px;
            margin: 0;
            padding: 0;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 40px;
        }

        .positionGame:nth-child(1) {
            border-right: 4px solid #F4E9C1;
            border-bottom: 4px solid #F4E9C1;
        }

        .positionGame:nth-child(2) {
            border-right: 4px solid #F4E9C1;
            border-bottom: 4px solid #F4E9C1;
        }

        .positionGame:nth-child(3) {
            border-bottom: 4px solid #F4E9C1;
        }

        .positionGame:nth-child(4) {
            border-right: 4px solid #F4E9C1;
            border-bottom: 4px solid #F4E9C1;
        }

        .positionGame:nth-child(5) {
            border-right: 4px solid #F4E9C1;
            border-bottom: 4px solid #F4E9C1;
        }

        .positionGame:nth-child(6) {
            border-bottom: 4px solid #F4E9C1;
        }

        .positionGame:nth-child(7) {
            border-right: 4px solid #F4E9C1;
        }

        .positionGame:nth-child(8) {
            border-right: 4px solid #F4E9C1;
        }

        #winnerDiv {
            font-size: 40px;
            color: #F4E9C1;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 30px;
        }

        #winnerDiv img {
            margin-left: 10px;
        }

        .img-first-move {
            height: 30px;
            margin-left: 3px;
        }

        #dvWhoStarts {
            display: flex;
            align-items: center;
            margin-top: 12px;
            color: #fff;
            font-size: 24px;
        }

        .select {
            background: transparent;
            border: 1px solid #86C2B4;;
            border-radius: 10px;
            width: 45px;
            height: 40px;
            font-size: 25px;
            color: #717171;
            margin-bottom: 10px;
        }

        .select-lvl {
            font-size: 18px;
            width: 80px;
        }
        
        option {
            color: #717171;
        }

        .choose {
            font-size: 25px;
            color: #86C2B4;;
        }

        .btn-start {
            background: transparent;
            border: 2px solid #F4E9C1;
            border-radius: 50px;
            font-size: 20px;
            padding: 7px 30px;
            margin-top: 15px;
            color: #fff;
            cursor: pointer;
            margin-left: 50%;
            transform: translateX(-50%);
        }
    </style>
</head>
<body>
    <div id="dvmenu">
        <div id="">
            <span class="choose">Choose your Symbol: </span>
            <select name="" class="select" id="dvPlayerSymbol">
                <option value="X" selected="selected">x</option>
                <option value="O">O</option>
            </select>
        </div>
        <div id="">
                <span class="choose">Choose the level: </span>
                <select name="" class="select select-lvl" id="dvPlayerLevel">
                    <option value="1" selected="selected">Easy</option>
                    <option value="2">Hard</option>
                </select>
            </div>
            <div id="dvWhoStarts"></div>
    </div>
    <div id="winnerDiv"></div>
    <div id="dvGame">
        <div id="p1" class="positionGame" onclick="play(1)"></div>
        <div id="p2" class="positionGame" onclick="play(2)"></div>
        <div id="p3" class="positionGame" onclick="play(3)"></div>
        <div id="p4" class="positionGame" onclick="play(4)"></div>
        <div id="p5" class="positionGame" onclick="play(5)"></div>
        <div id="p6" class="positionGame" onclick="play(6)"></div>
        <div id="p7" class="positionGame" onclick="play(7)"></div>
        <div id="p8" class="positionGame" onclick="play(8)"></div>
        <div id="p9" class="positionGame" onclick="play(9)"></div>
    </div>
    <button class="btn-start" onclick="start()">Start Game</button>
    <script>
            var game = []; // save the positions of plays X or O
            var board = []; // control of visual elements
            var whoPlays = 0; // 0 = Player and 1 = Cpu
            var check; // store the result of function checkVictory()
            var gameOver = false;
            var difficulty = 2;
            var whoStart = 1;
            var playerSymbol;
            var cpuSymbol;
            var played = 0; // count the number of plays

            function setSymbol() {
                playerSymbol = document.getElementById("dvPlayerSymbol").value;
                if (playerSymbol == "X") {
                    cpuSymbol = "O";
                } else {
                    cpuSymbol = "X";
                }
            }

            function cpuPlaying() {
                if(!gameOver) {
                    var line;
                    var column;
                    if(difficulty == 1) {
                        do { // first sortition a random position
                            line = Math.round(Math.random()*2);
                            column = Math.round(Math.random()*2);
                        } while (game[line][column] != ""); // then verify if the position is empty
                        game[line][column] = cpuSymbol; //this will be dinamic **
    
                    } else if (difficulty == 2) {
                        // level 2
                        // Atack
                        // Possible plays on line 1
                        if ( (game[0][0] == cpuSymbol)&&(game[0][1] == cpuSymbol)&&(game[0][2] == "") ) {
                            game[0][2] = cpuSymbol; 
                        } else if ( (game[0][0] == cpuSymbol)&&(game[0][2] == cpuSymbol)&&(game[0][1] == "") ) {
                            game[0][1] = cpuSymbol;
                        } else if ( (game[0][1] == cpuSymbol)&&(game[0][2] == cpuSymbol)&&(game[0][0] == "") ) {
                            game[0][0] = cpuSymbol;
                        } else
                        // Possible plays on line 2
                        if ( (game[1][0] == cpuSymbol)&&(game[1][1] == cpuSymbol)&&(game[1][2] == "") ) {
                            game[1][2] = cpuSymbol; 
                        } else if ( (game[1][0] == cpuSymbol)&&(game[1][2] == cpuSymbol)&&(game[1][1] == "") ) {
                            game[1][1] = cpuSymbol;
                        } else if ( (game[1][1] == cpuSymbol)&&(game[1][2] == cpuSymbol)&&(game[1][0] == "") ) {
                            game[1][0] = cpuSymbol;
                        } else
                        // Possible plays on line 3
                        if ( (game[2][0] == cpuSymbol)&&(game[2][1] == cpuSymbol)&&(game[2][2] == "") ) {
                            game[2][2] = cpuSymbol; 
                        } else if ( (game[2][0] == cpuSymbol)&&(game[2][2] == cpuSymbol)&&(game[2][1] == "") ) {
                            game[1][1] = cpuSymbol;
                        } else if ( (game[2][1] == cpuSymbol)&&(game[2][2] == cpuSymbol)&&(game[2][0] == "") ) {
                            game[2][0] = cpuSymbol;
                        } else
                        // Possible plays on column 1
                        if ( (game[0][0] == cpuSymbol)&&(game[1][0] == cpuSymbol)&&(game[2][0] == "") ) {
                            game[2][0] = cpuSymbol; 
                        } else if ( (game[0][0] == cpuSymbol)&&(game[2][0] == cpuSymbol)&&(game[1][0] == "") ) {
                            game[1][0] = cpuSymbol;
                        } else if ( (game[1][0] == cpuSymbol)&&(game[2][0] == cpuSymbol)&&(game[0][0] == "") ) {
                            game[0][0] = cpuSymbol;
                        } else
                        // Possible plays on column 2
                        if ( (game[0][1] == cpuSymbol)&&(game[1][1] == cpuSymbol)&&(game[2][1] == "") ) {
                            game[2][1] = cpuSymbol; 
                        } else if ( (game[0][1] == cpuSymbol)&&(game[2][1] == cpuSymbol)&&(game[1][1] == "") ) {
                            game[1][1] = cpuSymbol;
                        } else if ( (game[1][1] == cpuSymbol)&&(game[2][1] == cpuSymbol)&&(game[0][1] == "") ) {
                            game[0][1] = cpuSymbol;
                        } else
                        // Possible plays on column 3
                        if ( (game[0][2] == cpuSymbol)&&(game[1][2] == cpuSymbol)&&(game[2][2] == "") ) {
                            game[2][2] = cpuSymbol; 
                        } else if ( (game[0][2] == cpuSymbol)&&(game[2][2] == cpuSymbol)&&(game[1][2] == "") ) {
                            game[1][2] = cpuSymbol;
                        } else if ( (game[1][2] == cpuSymbol)&&(game[2][2] == cpuSymbol)&&(game[0][2] == "") ) {
                            game[0][2] = cpuSymbol;
                        } else
                        // Possible play on diagonal 1 --> \
                        if ( (game[0][0] == cpuSymbol)&&(game[1][1] == cpuSymbol)&&(game[2][2] == "") ) {
                            game[2][2] = cpuSymbol; 
                        } else if ( (game[0][0] == cpuSymbol)&&(game[2][2] == cpuSymbol)&&(game[1][1] == "") ) {
                            game[1][1] = cpuSymbol;
                        } else if ( (game[1][1] == cpuSymbol)&&(game[2][2] == cpuSymbol)&&(game[0][0] == "") ) {
                            game[0][0] = cpuSymbol;
                        } else
                        // Possible play on diagonal 2 --> /
                        if ( (game[0][2] == cpuSymbol)&&(game[1][1] == cpuSymbol)&&(game[2][0] == "") ) {
                            game[2][0] = cpuSymbol; 
                        } else if ( (game[0][2] == cpuSymbol)&&(game[2][0] == cpuSymbol)&&(game[1][1] == "") ) {
                            game[1][1] = cpuSymbol;
                        } else if ( (game[2][0] == cpuSymbol)&&(game[1][1] == cpuSymbol)&&(game[0][2] == "") ) {
                            game[0][2] = cpuSymbol;
                        } else
                        // Defend
                        // Possible plays on line 1
                        if ( (game[0][0] == playerSymbol)&&(game[0][1] == playerSymbol)&&(game[0][2] == "") ) {
                            game[0][2] = cpuSymbol; 
                        } else if ( (game[0][0] == playerSymbol)&&(game[0][2] == playerSymbol)&&(game[0][1] == "") ) {
                            game[0][1] = cpuSymbol;
                        } else if ( (game[0][1] == playerSymbol)&&(game[0][2] == playerSymbol)&&(game[0][0] == "") ) {
                            game[0][0] = cpuSymbol;
                        } else
                        // Possible plays on line 2
                        if ( (game[1][0] == playerSymbol)&&(game[1][1] == playerSymbol)&&(game[1][2] == "") ) {
                            game[1][2] = cpuSymbol; 
                        } else if ( (game[1][0] == playerSymbol)&&(game[1][2] == playerSymbol)&&(game[1][1] == "") ) {
                            game[1][1] = cpuSymbol;
                        } else if ( (game[1][1] == playerSymbol)&&(game[1][2] == playerSymbol)&&(game[1][0] == "") ) {
                            game[1][0] = cpuSymbol;
                        } else
                        // Possible plays on line 3
                        if ( (game[2][0] == playerSymbol)&&(game[2][1] == playerSymbol)&&(game[2][2] == "") ) {
                            game[2][2] = cpuSymbol; 
                        } else if ( (game[2][0] == playerSymbol)&&(game[2][2] == playerSymbol)&&(game[2][1] == "") ) {
                            game[1][1] = cpuSymbol;
                        } else if ( (game[2][1] == playerSymbol)&&(game[2][2] == playerSymbol)&&(game[2][0] == "") ) {
                            game[2][0] = cpuSymbol;
                        } else
                        // Possible plays on column 1
                        if ( (game[0][0] == playerSymbol)&&(game[1][0] == playerSymbol)&&(game[2][0] == "") ) {
                            game[2][0] = cpuSymbol; 
                        } else if ( (game[0][0] == playerSymbol)&&(game[2][0] == playerSymbol)&&(game[1][0] == "") ) {
                            game[1][0] = cpuSymbol;
                        } else if ( (game[1][0] == playerSymbol)&&(game[2][0] == playerSymbol)&&(game[0][0] == "") ) {
                            game[0][0] = cpuSymbol;
                        } else
                        // Possible plays on column 2
                        if ( (game[0][1] == playerSymbol)&&(game[1][1] == playerSymbol)&&(game[2][1] == "") ) {
                            game[2][1] = cpuSymbol; 
                        } else if ( (game[0][1] == playerSymbol)&&(game[2][1] == playerSymbol)&&(game[1][1] == "") ) {
                            game[1][1] = cpuSymbol;
                        } else if ( (game[1][1] == playerSymbol)&&(game[2][1] == playerSymbol)&&(game[0][1] == "") ) {
                            game[0][1] = cpuSymbol;
                        } else
                        // Possible plays on column 3
                        if ( (game[0][2] == playerSymbol)&&(game[1][2] == playerSymbol)&&(game[2][2] == "") ) {
                            game[2][2] = cpuSymbol; 
                        } else if ( (game[0][2] == playerSymbol)&&(game[2][2] == playerSymbol)&&(game[1][2] == "") ) {
                            game[1][2] = cpuSymbol;
                        } else if ( (game[1][2] == playerSymbol)&&(game[2][2] == playerSymbol)&&(game[0][2] == "") ) {
                            game[0][2] = cpuSymbol;
                        } else
                        // Possible play on diagonal 1 --> \
                        if ( (game[0][0] == playerSymbol)&&(game[1][1] == playerSymbol)&&(game[2][2] == "") ) {
                            game[2][2] = cpuSymbol; 
                        } else if ( (game[0][0] == playerSymbol)&&(game[2][2] == playerSymbol)&&(game[1][1] == "") ) {
                            game[1][1] = cpuSymbol;
                        } else if ( (game[1][1] == playerSymbol)&&(game[2][2] == playerSymbol)&&(game[0][0] == "") ) {
                            game[0][0] = cpuSymbol;
                        } else
                        // Possible play on diagonal 2 --> /
                        if ( (game[0][2] == playerSymbol)&&(game[1][1] == playerSymbol)&&(game[2][0] == "") ) {
                            game[2][0] = cpuSymbol; 
                        } else if ( (game[0][2] == playerSymbol)&&(game[2][0] == playerSymbol)&&(game[1][1] == "") ) {
                            game[1][1] = cpuSymbol;
                        } else if ( (game[2][0] == playerSymbol)&&(game[1][1] == playerSymbol)&&(game[0][2] == "") ) {
                            game[0][2] = cpuSymbol;
                        } else {
                            if (played < 8 ) {
                                do { // first sortition a random position
                                    line = Math.round(Math.random()*2);
                                    column = Math.round(Math.random()*2);
                                } while (game[line][column] != ""); // then verify if the position is empty
                                game[line][column] = cpuSymbol; //this will be dinamic **
                            } else {
                                for(var line = 0; line < 3; line++) { 
                                    for(var column = 0; column < 3; column++ ) {
                                        if(game[line][column] == "") {
                                            game[line][column] == cpuSymbol;
                                        }
                                    }
                                }
                            }
                        }
                        //end level 2
                    }
                    check = checkVictory();
                    if (check != "") {
                        document.getElementById("winnerDiv").innerHTML = "The winner is <img src='images/" + check + ".png' alt='X Symbol'>";
                        gameOver = true;
                    }
                    refreshBoard();
                    played++;
                    whoPlays = 0; // set the next play to PLayer
                }
            }
    
            function checkVictory() { // checa a vitoria
                var line;
                var column;
                //check all 3 lines
                for (line = 0; line < 3; line++) { 
                    if ( (game[line][0] == game[line][1])&&(game[line][1]==game[line][2]) ){
                        return game[line][0]; // Return de winner
                    }
                }
    
                //check all 3 columns
                for (column = 0; column < 3; column++) { 
                    if ( (game[0][column] == game[1][column])&&(game[1][column]==game[2][column]) ){
                        return game[0][column]; // Return de winner
                    }
                }
    
                //check Diagonal 1 --> \
                if ( (game[0][0] == game[1][1])&&(game[1][1]==game[2][2]) ){
                    return game[0][0]; // Return de winner
                }
    
                //check Diagonal 2 --> /
                if ( (game[0][2] == game[1][1])&&(game[1][1]==game[2][0]) ){
                    return game[0][2]; // Return de winner
                }
                return "";
            }
    
    
            function play(p) { // the parameter is the position of the element
                if ((!gameOver)&&(whoPlays == 0)) { //if gameOver still false and whoPlays is the player
                    switch(p) {
                        case 1:
                            if(game[0][0] == ""){ // Verify if the position is valid
                                game[0][0] = playerSymbol; //this will be dinamic **
                                whoPlays = 1; // set the next play to Cpu
                            }
                            break;
                        case 2:
                            if(game[0][1] == ""){
                                game[0][1] = playerSymbol;
                                whoPlays = 1; 
                            }
                            break;
                        case 3:
                            if(game[0][2] == ""){
                                game[0][2] = playerSymbol;
                                whoPlays = 1;
                            }
                            break;
                        case 4:
                            if(game[1][0] == ""){
                                game[1][0] = playerSymbol;
                                whoPlays = 1;
                            }
                            break;
                        case 5:
                            if(game[1][1] == ""){
                                game[1][1] = playerSymbol;
                                whoPlays = 1;
                            }
                            break;
                        case 6:
                            if(game[1][2] == ""){
                                game[1][2] = playerSymbol;
                                whoPlays = 1;
                            }
                            break;
                        case 7:
                            if(game[2][0] == ""){
                                game[2][0] = playerSymbol;
                                whoPlays = 1;
                            }
                        break;
                        case 8:
                            if(game[2][1] == ""){
                                game[2][1] = playerSymbol;
                                whoPlays = 1;
                            }
                        break;
                        case 9:
                            if(game[2][2] == ""){
                                game[2][2] = playerSymbol;
                                whoPlays = 1;
                            }
                        break;
                    }
                    if (whoPlays == 1) { // for have sure if the position is valid. 
                        refreshBoard();
                        check = checkVictory();
                        if (check != "") {
                            document.getElementById("winnerDiv").innerHTML = "The winner is <img src='images/" + check + ".png' alt='X Symbol'>";
                            gameOver = true;
                        }
                        played++;
                        cpuPlaying();
                    }
                }
            }
    
            function start() {
                document.getElementById("winnerDiv").innerHTML = "";
                setSymbol();
                gameOver = false;
                var difficulty = document.getElementById("dvPlayerLevel").value;
                played = 0;
                cpuPlay = 1;
                game = [
                        ["","",""],
                        ["","",""],
                        ["","",""]
                ];
                board = [
                    [document.getElementById("p1"),document.getElementById("p2"),document.getElementById("p3")],
                    [document.getElementById("p4"),document.getElementById("p5"),document.getElementById("p6")],
                    [document.getElementById("p7"),document.getElementById("p8"),document.getElementById("p9")]
                ];
                refreshBoard();
                if (whoStart == 1) {
                    whoStart = 0; // inverte **
                    whoPlays = whoStart;
                    document.getElementById("dvWhoStarts").innerHTML = "The first movement is: " + "<img src='images/" + playerSymbol + ".png' alt='X Symbol' class='img-first-move'>";
                } else {
                    whoStart = 1; // inverte **
                    whoPlays = whoStart;
                    cpuPlaying();
                    document.getElementById("dvWhoStarts").innerHTML = "The first movement is: CPU";
                }
            }
    
            function refreshBoard() {
                for(var line = 0; line < 3; line++) { // one for to the lines
                    for(var column = 0; column < 3; column++ ) { // one for to the columns
                        if (game[line][column] == playerSymbol) {
                            board[line][column].innerHTML = "<img src='images/" + playerSymbol + ".png' alt='X Symbol'>";
                            board[line][column].style.cursor = "default";
                        } else if (game[line][column] == cpuSymbol) {
                            board[line][column].innerHTML = "<img src='images/" + cpuSymbol + ".png' alt='X Symbol'>";
                            board[line][column].style.cursor = "default";
                        } else {
                            board[line][column].innerHTML = "";
                            board[line][column].style.cursor = "pointer";
                        }
                    }
                }
            }
    
            window.addEventListener("load", start);
        </script>
</body>
</html>